<script>
;(function ($, window, document, undefined) {
    "use strict";
    function debounce(func, wait, immediate) {
        var timeout;
        return function () {
            var context = this;
            var args = arguments;
            var later = function () {
                timeout = null;
                if (!immediate) {
                    func.apply(context, args);
                }
            };
            var callNow = immediate && !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) {
                func.apply(context, args);
            }
        };
    }
    $(window).load(function () {
        var grid = document.querySelector('#masonry');
        var msnry;
        imagesLoaded(grid, function () {
            if (Modernizr.csstransitions) {
                msnry = new Masonry(grid, {
                    itemSelector: '.item',
                    columnWidth: 1,
                    percentPosition: true,
                    transitionDuration: 0
                });
            } else {
                msnry = new Masonry(grid, {
                    itemSelector: '.item',
                    columnWidth: 1,
                    percentPosition: true,
                    transitionDuration: '.2s'
                });
            }
        });
    });
    $(function () {
        var $window_top = $(window);
        var $nav_top = $('#navbar').offset().top;
        var $place = $('#place-holder');
        var $place_top = 0;
        var prev_place_top = 0;
        var get_offset = debounce(function () { 
            $place_top = $place.offset().top;
            if ($place_top <= prev_place_top) {
                if ($place_top > $nav_top) {
                    prev_place_top = $place_top;
                    $nav_top = $place_top;
                } else {
                    $nav_top = $('#navbar').offset().top;
                }
            }
        }, 5);
        var navbar_stick = debounce(function () {
            get_offset();
            if ($window_top.scrollTop() >= $nav_top) {
                $('#navbar').addClass('scroll-stick');
                $('#place-holder').removeClass('remove');
            } else {
                $('#navbar').removeClass('scroll-stick');
                $('#place-holder').addClass('remove');
            }
        }, 0);
        $(window).load(function () {
            navbar_stick();
        });
        $(window).scroll(navbar_stick);
        $(window).resize(navbar_stick);
    });
})( window.jQuery, window, document);
</script>
